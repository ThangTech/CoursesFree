<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ph·∫£n H·ªìi - H·ªçc L·∫≠p Tr√¨nh Online</title>
    <link
      rel="shortcut icon"
      href="../../public/Storage/Images/icons8-books-emoji-48.png"
      type="image/x-icon"
    />
    <link rel="stylesheet" href="../CSS/feedback.css" />
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"
    ></script>
    <script type="text/javascript">
      (function () {
        emailjs.init("Rc4kZ8c8pIjFSmBpy");
      })();
    </script>
  </head>
  <body>
    <div class="container">
      <header class="header">
        <h1>Ph·∫£n H·ªìi C·ªßa B·∫°n</h1>
        <p>√ù ki·∫øn c·ªßa b·∫°n gi√∫p ch√∫ng t√¥i c·∫£i thi·ªán tr·∫£i nghi·ªám h·ªçc t·∫≠p</p>
      </header>

      <main class="content">
        <form id="feedbackForm">
          <div class="form-group">
            <label for="name">H·ªç v√† T√™n</label>
            <input
              type="text"
              id="name"
              name="name"
              placeholder="Nh·∫≠p h·ªç v√† t√™n c·ªßa b·∫°n"
              required
            />
          </div>

          <div class="form-group">
            <label for="email">Email</label>
            <input
              type="email"
              id="email"
              name="email"
              placeholder="email@example.com"
              required
            />
          </div>

          <div class="form-group">
            <label for="course">Kh√≥a H·ªçc</label>
            <select id="course" name="course" required>
              <option value="">-- Ch·ªçn kh√≥a h·ªçc --</option>
              <option value="html">HTML</option>
              <option value="css">CSS</option>
              <option value="javascript">JavaScript</option>
              <option value="python">Python</option>
              <option value="java">Java</option>
              <option value="cpp">C++</option>
              <option value="sql">SQL</option>
              <option value="react">React</option>
              <option value="nodejs">Node.js</option>
            </select>
          </div>

          <div class="form-group">
            <label>ƒê√°nh Gi√° Ch·∫•t L∆∞·ª£ng Kh√≥a H·ªçc</label>
            <div class="rating-group">
              <div class="rating-option">
                <input
                  type="radio"
                  id="rating4"
                  name="rating"
                  value="4"
                  required
                />
                <label for="rating4"
                  ><span class="emoji">‚≠ê</span>Xu·∫•t s·∫Øc</label
                >
              </div>
              <div class="rating-option">
                <input type="radio" id="rating3" name="rating" value="3" />
                <label for="rating3"><span class="emoji">üòä</span>T·ªët</label>
              </div>
              <div class="rating-option">
                <input type="radio" id="rating2" name="rating" value="2" />
                <label for="rating2"
                  ><span class="emoji">üòê</span>Trung b√¨nh</label
                >
              </div>
              <div class="rating-option">
                <input type="radio" id="rating1" name="rating" value="1" />
                <label for="rating1"><span class="emoji">üòï</span>K√©m</label>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="feedback">√ù Ki·∫øn C·ªßa B·∫°n</label>
            <textarea
              id="feedback"
              name="feedback"
              placeholder="Chia s·∫ª tr·∫£i nghi·ªám c·ªßa b·∫°n v·ªÅ kh√≥a h·ªçc, n·ªôi dung, gi·∫£ng vi√™n, ho·∫∑c b·∫•t k·ª≥ g√≥p √Ω n√†o..."
              required
            ></textarea>
          </div>

          <button type="submit" class="submit-btn">G·ª≠i Ph·∫£n H·ªìi</button>

          <div class="btn-back">
              <a href="../../index.html">Quay v·ªÅ trang ch·ªß</a>
          </div>
          <div id="successMessage" class="success-message">
            <span class="emoji"></span>
            C·∫£m ∆°n b·∫°n ƒë√£ g·ª≠i ph·∫£n h·ªìi! Ch√∫ng t√¥i s·∫Ω xem x√©t v√† c·∫£i thi·ªán d·ªãch
            v·ª•.
          </div>
        </form>
      </main>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("feedbackForm");
        const successMessage = document.getElementById("successMessage");

        const validateForm = (formData) => {
          const errors = [];

          if (!formData.get("name").trim()) errors.push("Vui l√≤ng nh·∫≠p h·ªç t√™n");

          if (!formData.get("email").trim()) errors.push("Vui l√≤ng nh·∫≠p email");

          if (!formData.get("course")) errors.push("Vui l√≤ng ch·ªçn kh√≥a h·ªçc");

          if (!formData.get("rating"))
            errors.push("Vui l√≤ng ƒë√°nh gi√° kh√≥a h·ªçc");

          if (!formData.get("feedback").trim())
            errors.push("Vui l√≤ng nh·∫≠p √Ω ki·∫øn ph·∫£n h·ªìi");

          return errors;
        };

        const submitForm = async (formData) => {
          try {
            const templateParams = {
              name: formData.get("name"),
              email: formData.get("email"),
              course: formData.get("course"),
              rating: formData.get("rating"),
              feedback: formData.get("feedback"),
            };

            await emailjs.send(
              "service_d9c9m0s", 
              "template_ln681q9", 
              templateParams
            );

            successMessage.classList.add("show");
            form.reset();

            setTimeout(() => {
              successMessage.classList.remove("show");
            }, 5000);
          } catch (error) {
            console.error("FAILED...", error);
            alert("C√≥ l·ªói x·∫£y ra khi g·ª≠i ph·∫£n h·ªìi!");
          }
        };

        form.addEventListener("submit", async (e) => {
          e.preventDefault();
          const submitBtn = form.querySelector(".submit-btn");
          submitBtn.disabled = true;
          submitBtn.innerHTML = "ƒêang g·ª≠i...";

          const formData = new FormData(form);
          const errors = validateForm(formData);

          if (errors.length > 0) {
            alert(errors.join("\n"));
            submitBtn.disabled = false;
            submitBtn.innerHTML = "G·ª≠i Ph·∫£n H·ªìi";
            return;
          }

          await submitForm(formData);
          submitBtn.disabled = false;
          submitBtn.innerHTML = "G·ª≠i Ph·∫£n H·ªìi";
        });
      });
    </script>
  </body>
</html>
